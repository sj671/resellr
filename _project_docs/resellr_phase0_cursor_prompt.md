# Resellr — Phase 0 (Cursor AI Project Rules)
Copy-paste this entire block into a new Cursor chat to scaffold Phase 0.

> **SYSTEM / PROJECT RULES FOR CURSOR (ONE SHOT)**
>
> **Goal:** Create Phase 0 of a modern reseller PWA named **Resellr** using **Next.js 15 (App Router, TS)**, **Tailwind**, **shadcn/ui**, and **Supabase (Data API via PostgREST + SQL migrations)**. No business features yet. Deliver a polished PWA shell, design tokens, and Supabase client wiring with generated DB types. **Do NOT use Prisma.**
>
> ---
> ### Tech & Style Constraints
> - Next.js 15+, TypeScript, App Router, `/src` directory, alias `@/*`.
> - Tailwind + shadcn/ui components, dark/light theming via CSS variables.
> - PWA: `next-pwa` with manifest & service worker (installable in prod).
> - Supabase: use **Supabase JS client** (`@supabase/supabase-js`) against PostgREST & RPC. **No ORM.**
> - Migrations: **Supabase CLI** SQL files in `supabase/migrations`.
> - Types: generate with `supabase gen types typescript --linked` into `src/types/database.ts`.
> - DX: pnpm scripts; clean TypeScript and ESLint.
>
> ---
> ### Implement These Tasks
> 1) **Scaffold**
>    - Create project `resellr` with Next.js 15, TS, ESLint, `--app`, `--src-dir`, alias `@/*`.
>    - Add dependencies:
>      - UI: `tailwindcss postcss autoprefixer -D`, `shadcn-ui`, `tailwindcss-animate`
>      - Supabase: `@supabase/supabase-js`
>      - PWA: `next-pwa`
>      - Charts (later): `recharts`
>
> 2) **Tailwind setup**
>    - `tailwind.config.ts` with `darkMode: ["class"]`, `content: ["./src/**/*.{ts,tsx}"]`, centered container (2xl: 1400px), extended color tokens bound to CSS vars (border, input, ring, background, foreground, primary, secondary, muted, accent, destructive, card), radius tokens, and plugin `tailwindcss-animate`.
>    - `postcss.config.js` as standard.
>    - `src/styles/globals.css` with `:root` and `.dark` HSL token variables + `@tailwind base/components/utilities`.
>
> 3) **shadcn/ui**
>    - Init shadcn and add components: `button input card table dialog dropdown-menu form toast sheet badge tooltip tabs textarea select avatar progress`.
>
> 4) **App shell + PWA**
>    - `src/app/layout.tsx` with `Metadata` (title “Resellr — modern reseller PWA”), `themeColor` for light/dark, link to `/manifest.webmanifest`, `<body className="bg-background text-foreground antialiased">`.
>    - Components:
>      - `src/components/header.tsx`: brand “Resellr”, nav placeholders (Dashboard, Inventory, Sales, Expenses, Insights), a dark-mode toggle, and mobile Sheet menu.
>      - `src/components/footer.tsx`: minimal footer with Privacy/Terms placeholders.
>      - `src/components/theme-toggle.tsx`: simple class-based dark/light toggle.
>    - `src/app/page.tsx`: landing hero (headline + subtext), CTA buttons (“Get started”, “Learn more”), and a 3-card grid (“Inventory”, “Sales”, “Expenses”) using shadcn `Card`.
>    - `next.config.mjs`:
>      - Wrap with `next-pwa` (`dest: "public"`, `register: true`, `skipWaiting: true`, `disable` if not prod).
>      - Add security headers: `X-Frame-Options: SAMEORIGIN`, `Referrer-Policy: strict-origin-when-cross-origin`, `Permissions-Policy: camera=(), microphone=(), geolocation=()`.
>    - `public/manifest.webmanifest` with name/short_name “Resellr”, `display: "standalone"`, theme/background colors, and 192/512 icons.
>    - Placeholder icons at `public/icons/icon-192.png` and `public/icons/icon-512.png`.
>
> 5) **Supabase wiring (Data API)**
>    - **Do not add Prisma/Drizzle.** Use **Supabase JS** only.
>    - Create `src/lib/supabase/client.ts` and `src/lib/supabase/server.ts`:
>      - `client.ts`: `createBrowserClient` using `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY`.
>      - `server.ts`: `createServerClient` helper for route handlers/server actions (read cookies, set cookies).
>    - Add `.env.local.example`:
>      ```
>      NEXT_PUBLIC_SUPABASE_URL=
>      NEXT_PUBLIC_SUPABASE_ANON_KEY=
>      # Optional for local scripts or RPC testing, keep out of client code:
>      SUPABASE_SERVICE_ROLE=
>      ```
>    - Add `src/types/database.ts` placeholder comment: “Generated by Supabase CLI” (we will generate in README steps).
>
> 6) **DB schema (SQL) + RLS**
>    - Create `supabase/migrations/00000000000000_init.sql` containing:
>      - Extension enables (if needed): `create extension if not exists "uuid-ossp";`
>      - A minimal `public.profiles` table linked to `auth.users`:
>        ```sql
>        create table if not exists public.profiles (
>          id uuid primary key references auth.users(id) on delete cascade,
>          email text unique,
>          display_name text,
>          avatar_url text,
>          created_at timestamptz not null default now(),
>          updated_at timestamptz not null default now()
>        );
>        ```
>      - RLS on `profiles` with policies:
>        - Enable RLS.
>        - `select` policy: user can read their own row.
>        - `insert` policy: user can insert a row where `id = auth.uid()`.
>        - `update` policy: user can update their own row.
>        ```sql
>        alter table public.profiles enable row level security;
>        create policy "read own profile" on public.profiles for select using (id = auth.uid());
>        create policy "insert own profile" on public.profiles for insert with check (id = auth.uid());
>        create policy "update own profile" on public.profiles for update using (id = auth.uid());
>        ```
>      - Trigger to keep `updated_at` fresh:
>        ```sql
>        create or replace function public.touch_updated_at() returns trigger as $$
>        begin new.updated_at = now(); return new; end; $$ language plpgsql;
>        drop trigger if exists trg_profiles_touch on public.profiles;
>        create trigger trg_profiles_touch before update on public.profiles
>        for each row execute procedure public.touch_updated_at();
>        ```
>    - Do **not** add business tables yet.
>
> 7) **Pages & wiring for Supabase (no auth flow yet)**
>    - Add a simple server action or route handler example that **reads** `profiles` for the current session if present (no UI to sign in yet; just safe SSR helper).
>    - In `Header`, show a placeholder “Sign in” button (non-functional for now) and a spot for a user avatar later.
>
> 8) **Scripts & README**
>    - `package.json` scripts:
>      ```json
>      {
>        "scripts": {
>          "dev": "next dev",
>          "build": "next build",
>          "start": "next start",
>          "typecheck": "tsc --noEmit",
>          "lint": "next lint",
>          "format": "prettier --write .",
>          "db:types": "supabase gen types typescript --linked --output src/types/database.ts"
>        }
>      }
>      ```
>    - `README.md` with clear steps:
>      1. **Install & setup**
>         ```bash
>         pnpm i
>         # Supabase CLI must be installed: https://supabase.com/docs/guides/cli
>         supabase init
>         supabase start   # spins up local Supabase (db, auth, studio)
>         ```
>      2. **Migrations**
>         ```bash
>         supabase migration up
>         ```
>      3. **Generate types**
>         ```bash
>         pnpm run db:types
>         ```
>      4. **Env**
>         - Copy `.env.local.example` to `.env.local` and set:
>           - `NEXT_PUBLIC_SUPABASE_URL` (from `supabase status` or local Studio)
>           - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
>      5. **Run app**
>         ```bash
>         pnpm dev
>         ```
>      6. **PWA local test**
>         ```bash
>         pnpm build && pnpm start
>         # Open http://localhost:3000, use Chrome "Install app"
>         ```
>      7. **Notes**
>         - All DB access uses **Supabase Data API** (PostgREST + RPC) via `@supabase/supabase-js`.
>         - Use RLS for security. For multi-step writes later, create SQL functions and call with `supabase.rpc()`.
>
> ---
> ### Acceptance Criteria
> - `pnpm dev` shows a modern landing page with responsive header/footer and a working dark-mode toggle.
> - `pnpm build && pnpm start` yields a PWA-installable app (manifest + service worker).
> - Supabase files exist (`supabase/config.toml`, `supabase/migrations/..._init.sql`).
> - Type generation script `pnpm run db:types` outputs `src/types/database.ts`.
> - `src/lib/supabase/client.ts` and `src/lib/supabase/server.ts` exist and compile.
> - No TypeScript errors (`pnpm typecheck` passes).
> - **No Prisma or ORM added.**
>
> ---
> ### After you finish
> - Print **WHAT CHANGED** summary and the exact commands:
>   ```
>   pnpm i
>   supabase init
>   supabase start
>   supabase migration up
>   pnpm run db:types
>   pnpm dev
>   ```
> - Also print how to test PWA locally:
>   ```
>   pnpm build && pnpm start
>   ```
> **Stop after Phase 0. Do not implement auth or business features yet.**

